\begin{isabellebody}%
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ {\isacharparenleft}{\isacharprime}id{\isacharparenright}\ state\ {\isacharequal}\ {\isachardoublequoteopen}{\isacharprime}id\ {\isasymRightarrow}\ int\ option{\isachardoublequoteclose}\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ {\isacharparenleft}{\isacharprime}id{\isacharparenright}\ operation\ {\isacharequal}\ {\isachardoublequoteopen}{\isacharprime}id\ state{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ option{\isacharunderscore}max\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}int\ option\ {\isasymRightarrow}\ int\ option\ {\isasymRightarrow}\ int\ option{\isachardoublequoteclose}\ \ \isakeyword{where}\isanewline
{\isachardoublequoteopen}option{\isacharunderscore}max\ {\isacharparenleft}Some\ a{\isacharparenright}\ {\isacharparenleft}Some\ b{\isacharparenright}\ {\isacharequal}\ Some\ {\isacharparenleft}max\ a\ b{\isacharparenright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
{\isachardoublequoteopen}option{\isacharunderscore}max\ x\ None\ {\isacharequal}\ x{\isachardoublequoteclose}\ {\isacharbar}\isanewline
{\isachardoublequoteopen}option{\isacharunderscore}max\ None\ y\ {\isacharequal}\ y{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ update\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}id\ state\ {\isasymRightarrow}\ {\isacharprime}id\ {\isasymRightarrow}\ {\isacharparenleft}int\ {\isasymRightarrow}\ int{\isacharparenright}\ {\isasymRightarrow}\ {\isacharparenleft}{\isacharprime}id\ operation{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}update\ x\ i\ fn\ {\isacharequal}\ {\isacharparenleft}case\ {\isacharparenleft}x\ i{\isacharparenright}\ of\isanewline
\ \ \ \ \ \ None\ \ \ \ \ \ \ {\isasymRightarrow}\ x{\isacharparenleft}i\ {\isacharcolon}{\isacharequal}\ Some{\isacharparenleft}fn\ {\isadigit{0}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ {\isacharbar}\ Some\ {\isacharparenleft}x{\isacharunderscore}i{\isacharparenright}\ {\isasymRightarrow}\ x{\isacharparenleft}i\ {\isacharcolon}{\isacharequal}\ Some{\isacharparenleft}fn\ x{\isacharunderscore}i{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ inc\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}id\ {\isasymRightarrow}\ {\isacharparenleft}{\isacharprime}id\ state{\isacharparenright}\ {\isasymRightarrow}\ {\isacharparenleft}{\isacharprime}id\ operation{\isacharparenright}{\isachardoublequoteclose}\ \ \isakeyword{where}\isanewline
{\isachardoublequoteopen}inc\ who\ st\ {\isacharequal}\ update\ st\ who\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ x\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ dec\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}id\ {\isasymRightarrow}\ {\isacharparenleft}{\isacharprime}id\ state{\isacharparenright}\ {\isasymRightarrow}\ {\isacharparenleft}{\isacharprime}id\ operation{\isacharparenright}{\isachardoublequoteclose}\ \ \isakeyword{where}\isanewline
{\isachardoublequoteopen}dec\ who\ st\ {\isacharequal}\ update\ st\ who\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ x\ {\isacharminus}\ {\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ gcounter{\isacharunderscore}op\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isacharprime}id\ operation{\isacharparenright}\ {\isasymRightarrow}\ {\isacharparenleft}{\isacharprime}id\ state{\isacharparenright}\ {\isasymrightharpoonup}\ {\isacharparenleft}{\isacharprime}id\ state{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}gcounter{\isacharunderscore}op\ theirs\ ours\ {\isacharequal}\ Some\ {\isacharparenleft}{\isasymlambda}\ x{\isachardot}\ option{\isacharunderscore}max\ {\isacharparenleft}theirs\ x{\isacharparenright}\ {\isacharparenleft}ours\ x{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{locale}\isamarkupfalse%
\ gcounter\ {\isacharequal}\ network{\isacharunderscore}with{\isacharunderscore}ops\ {\isacharunderscore}\ gcounter{\isacharunderscore}op\ {\isachardoublequoteopen}{\isasymlambda}\ x{\isachardot}\ None{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ gcounter{\isacharparenright}\ option{\isacharunderscore}max{\isacharunderscore}assoc{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}option{\isacharunderscore}max\ a\ {\isacharparenleft}option{\isacharunderscore}max\ b\ c{\isacharparenright}\ {\isacharequal}\ option{\isacharunderscore}max\ {\isacharparenleft}option{\isacharunderscore}max\ a\ b{\isacharparenright}\ c{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}induction\ a{\isacharsemicolon}\ induction\ b{\isacharsemicolon}\ induction\ c{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}auto{\isacharparenright}\isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ gcounter{\isacharparenright}\ option{\isacharunderscore}max{\isacharunderscore}commut{\isacharcolon}\ {\isachardoublequoteopen}option{\isacharunderscore}max\ a\ b\ {\isacharequal}\ option{\isacharunderscore}max\ b\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}induction\ a{\isacharsemicolon}\ induction\ b{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}auto{\isacharparenright}\isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ gcounter{\isacharparenright}\ {\isacharbrackleft}simp{\isacharbrackright}\ {\isacharcolon}\ {\isachardoublequoteopen}gcounter{\isacharunderscore}op\ x\ {\isasymrhd}\ gcounter{\isacharunderscore}op\ y\ {\isacharequal}\ gcounter{\isacharunderscore}op\ y\ {\isasymrhd}\ gcounter{\isacharunderscore}op\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ kleisli{\isacharunderscore}def\ option{\isacharunderscore}max{\isacharunderscore}assoc{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ option{\isacharunderscore}max{\isacharunderscore}commut{\isacharparenright}\isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
\end{isabellebody}
